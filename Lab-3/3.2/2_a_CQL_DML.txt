CREATE KEYSPACE cbd_3_2 WITH replication = {'class': 'SimpleStrategy', 'replication_factor': 3};

USE cbd_3_2;


CREATE TABLE User(
   username text,
   name text,
   email text PRIMARY KEY,
   registration_date timestamp,
   );

CREATE TABLE Video(
   id int,
   name text,
   uploader_email text,
   description text,
   tags set<text>,
   followers_emails set<text>,
   upload_date timestamp,
   PRIMARY KEY(id, uploader_email, upload_date)
   ) WITH CLUSTERING ORDER BY (uploader_email ASC, upload_date DESC);

CREATE TABLE Video_By_Uploader(
   id int,
   name text,
   uploader_email text,
   description text,
   tags set<text>,
   followers_emails set<text>,
   upload_date timestamp,
   PRIMARY KEY(uploader_email, upload_date, id)
   );

CREATE TABLE Video_By_Username(
   id int,
   name text,
   uploader_user text,
   description text,
   tags set<text>,
   followers_emails set<text>,
   upload_date timestamp,
   PRIMARY KEY(uploader_user, upload_date, id)
   );

CREATE TABLE Tag_By_Video(
   id int,
   name text,
   video_id int,
   PRIMARY KEY(name, video_id, id)
   );


CREATE TABLE Comment_Video(
   id int,
   video_id int,
   reviewer_email text,
   comment text,
   creation_date timestamp,
   PRIMARY KEY (video_id, creation_date, id)
   ) WITH CLUSTERING ORDER BY (creation_date DESC);

CREATE TABLE Comment_Reviewer(
   id int,
   video_id int,
   reviewer_email text,
   comment text,
   creation_date timestamp,
   PRIMARY KEY(reviewer_email, creation_date, id)
   ) WITH CLUSTERING ORDER BY (creation_date DESC);

CREATE TABLE Event(
   id int,
   video_id int,
   user_email text ,
   creation_date timestamp,
   type int,
   time int,
   PRIMARY KEY(video_id, user_email, id)
   );

CREATE TABLE Rating(
   id int,
   video_id int,
   rating int,
   PRIMARY KEY (video_id, id)
   );


INSERT INTO User (username, name, email, registration_date) VALUES ('hugofpaiva', 'Hugo', 'hugofpaiva@ua.pt', toTimestamp(now()));
INSERT INTO User (username, name, email, registration_date) VALUES ('portugal', 'Daniel', 'portugal@ua.pt', toTimestamp(now()));
INSERT INTO User (username, name, email, registration_date) VALUES ('pateta', 'Bastos', 'pateta@ua.pt', toTimestamp(now()));
INSERT INTO User (username, name, email, registration_date) VALUES ('mouse', 'Eduardo', 'mouse@ua.pt', toTimestamp(now()));
INSERT INTO User (username, name, email, registration_date) VALUES ('bicho', 'Chico', 'bicho@ua.pt', toTimestamp(now()));
INSERT INTO User (username, name, email, registration_date) VALUES ('speedygonzalez', 'Leandro', 'speedy@ua.pt', toTimestamp(now()));
INSERT INTO User (username, name, email, registration_date) VALUES ('gonzalez', 'Gonzalez', 'gonzalez@ua.pt', toTimestamp(now()));
INSERT INTO User (username, name, email, registration_date) VALUES ('anahf', 'Ana', 'anahf@ua.pt', toTimestamp(now()));
INSERT INTO User (username, name, email, registration_date) VALUES ('patriciapa', 'Patricia', 'patriciapa@ua.pt', toTimestamp(now()));
INSERT INTO User (username, name, email, registration_date) VALUES ('hello_nomad', 'Nomad Good', 'hello_nomad@ua.pt', toTimestamp(now()));

INSERT INTO Video (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (1, 'iPhone 12 Unboxing', 'hugofpaiva@ua.pt', 'ASMR quick unboxing', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt', 'portugal@ua.pt'}, toTimestamp(now()));
INSERT INTO Video (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (2, 'iPhone X Unboxing', 'pateta@ua.pt', 'ASMR quick unboxing in 2018', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt'}, toTimestamp(now()));
INSERT INTO Video (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (3, 'Sociedade Musical Concerto Live 2019', 'speedy@ua.pt', 'Último concerto antes da pandemia...', {'Music', 'Traditional', '#BeforeQuarantineLife', 'Aveiro'}, {'portugal@ua.pt'}, toTimestamp(now()));
INSERT INTO Video (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (4, 'Earth Wind and Fire Live 1984 Japan', 'gonzalez@ua.pt', 'When Maurice White still gave the best shows', {'Music', '80s', 'Live', 'Earth Wind and Fire'}, {'hugofpaiva@ua.pt', 'anahf@ua.pt', 'patriciapa@ua.pt', 'hello_nomad@ua.pt'}, toTimestamp(now()));
INSERT INTO Video (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (5, 'iPad Air 2020 Review', 'bicho@ua.pt', 'The new replacement of the iPad Pro', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt', 'mouse@ua.pt', 'gonzalez@ua.pt'}, toTimestamp(now()));
INSERT INTO Video (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (6, 'Breaking a block of ice', 'mouse@ua.pt', 'Just because I can', {'Stupid', 'Ice'}, {}, toTimestamp(now()));
INSERT INTO Video (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (7, 'Buyin a new Lamborghini', 'hugofpaiva@ua.pt', 'Finaly made it!', {'Cars', 'Lamborghini', 'Lifestyle'}, {'gonzalez@ua.pt'}, toTimestamp(now()));
INSERT INTO Video (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (8, 'Dropping my sofa from a plane', 'hello_nomad@ua.pt', 'Can I do something more stupid?', {'Stupid', 'Sofa', 'Airplane'}, {'patriciapa@ua.pt'}, toTimestamp(now()));
INSERT INTO Video (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (9, 'iPhone 11 Pro Unboxing', 'speedy@ua.pt', 'ASMR unboxing', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt', 'portugal@ua.pt'}, toTimestamp(now()));
INSERT INTO Video (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (10, 'iPhone 3G Unboxing', 'hugofpaiva@ua.pt', 'unboxing', {'Apple', 'Tech', 'Unboxing'}, {'portugal@ua.pt'}, toTimestamp(now()));

INSERT INTO Video_By_Uploader (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (1, 'iPhone 12 Unboxing', 'hugofpaiva@ua.pt', 'ASMR quick unboxing', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt', 'portugal@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Uploader (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (2, 'iPhone X Unboxing', 'pateta@ua.pt', 'ASMR quick unboxing in 2018', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Uploader (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (3, 'Sociedade Musical Concerto Live 2019', 'speedy@ua.pt', 'Último concerto antes da pandemia...', {'Music', 'Traditional', '#BeforeQuarantineLife'}, {'portugal@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Uploader (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (4, 'Earth Wind and Fire Live 1984 Japan', 'gonzalez@ua.pt', 'When Maurice White still gave the best shows', {'Music', '80s', 'Live', 'Earth Wind and Fire'}, {'hugofpaiva@ua.pt', 'anahf@ua.pt', 'patriciapa@ua.pt', 'hello_nomad@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Uploader (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (5, 'iPad Air 2020 Review', 'bicho@ua.pt', 'The new replacement of the iPad Pro', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt', 'mouse@ua.pt', 'gonzalez@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Uploader (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (6, 'Breaking a block of ice', 'mouse@ua.pt', 'Just because I can', {'Stupid', 'Ice'}, {}, toTimestamp(now()));
INSERT INTO Video_By_Uploader (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (7, 'Buyin a new Lamborghini', 'hugofpaiva@ua.pt', 'Finaly made it!', {'Cars', 'Lamborghini', 'Lifestyle'}, {'gonzalez@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Uploader (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (8, 'Dropping my sofa from a plane', 'hello_nomad@ua.pt', 'Can I do something more stupid?', {'Stupid', 'Sofa', 'Airplane'}, {'patriciapa@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Uploader (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (9, 'iPhone 11 Pro Unboxing', 'speedy@ua.pt', 'ASMR unboxing', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt', 'portugal@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Uploader (id, name, uploader_email, description, tags, followers_emails, upload_date) VALUES (10, 'iPhone 3G Unboxing', 'hugofpaiva@ua.pt', 'unboxing', {'Apple', 'Tech', 'Unboxing'}, {'portugal@ua.pt'}, toTimestamp(now()));

INSERT INTO Video_By_Username (id, name, uploader_user, description, tags, followers_emails, upload_date) VALUES (1, 'iPhone 12 Unboxing', 'hugofpaiva', 'ASMR quick unboxing', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt', 'portugal@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Username (id, name, uploader_user, description, tags, followers_emails, upload_date) VALUES (2, 'iPhone X Unboxing', 'pateta', 'ASMR quick unboxing in 2018', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Username (id, name, uploader_user, description, tags, followers_emails, upload_date) VALUES (3, 'Sociedade Musical Concerto Live 2019', 'speedygonzalez', 'Último concerto antes da pandemia...', {'Music', 'Traditional', '#BeforeQuarantineLife'}, {'portugal@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Username (id, name, uploader_user, description, tags, followers_emails, upload_date) VALUES (4, 'Earth Wind and Fire Live 1984 Japan', 'gonzalez', 'When Maurice White still gave the best shows', {'Music', '80s', 'Live', 'Earth Wind and Fire'}, {'hugofpaiva@ua.pt', 'anahf@ua.pt', 'patriciapa@ua.pt', 'hello_nomad@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Username (id, name, uploader_user, description, tags, followers_emails, upload_date) VALUES (5, 'iPad Air 2020 Review', 'bicho', 'The new replacement of the iPad Pro', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt', 'mouse@ua.pt', 'gonzalez@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Username (id, name, uploader_user, description, tags, followers_emails, upload_date) VALUES (6, 'Breaking a block of ice', 'mouse', 'Just because I can', {'Stupid', 'Ice'}, {}, toTimestamp(now()));
INSERT INTO Video_By_Username (id, name, uploader_user, description, tags, followers_emails, upload_date) VALUES (7, 'Buyin a new Lamborghini', 'hugofpaiva', 'Finaly made it!', {'Cars', 'Lamborghini', 'Lifestyle'}, {'gonzalez@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Username (id, name, uploader_user, description, tags, followers_emails, upload_date) VALUES (8, 'Dropping my sofa from a plane', 'hello_nomad', 'Can I do something more stupid?', {'Stupid', 'Sofa', 'Airplane'}, {'patriciapa@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Username (id, name, uploader_user, description, tags, followers_emails, upload_date) VALUES (9, 'iPhone 11 Pro Unboxing', 'speedygonzalez', 'ASMR unboxing', {'Apple', 'Tech', 'Unboxing'}, {'hugofpaiva@ua.pt', 'portugal@ua.pt'}, toTimestamp(now()));
INSERT INTO Video_By_Username (id, name, uploader_user, description, tags, followers_emails, upload_date) VALUES (10, 'iPhone 3G Unboxing', 'hugofpaiva', 'unboxing', {'Apple', 'Tech', 'Unboxing'}, {'portugal@ua.pt'}, toTimestamp(now()));

INSERT INTO Tag_By_Video (id, name, video_id) VALUES (1, 'Apple', 1);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (2, 'Apple', 2);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (3, 'Apple', 5);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (4, 'Apple', 9);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (5, 'Apple', 10);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (6, 'Tech', 1);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (7, 'Tech', 2);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (8, 'Tech', 5);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (9, 'Tech', 9);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (10, 'Tech', 10);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (11, 'Unboxing', 1);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (12, 'Unboxing', 2);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (13, 'Unboxing', 5);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (14, 'Unboxing', 9);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (15, 'Unboxing', 10);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (16, 'Music', 3);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (17, 'Music', 4);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (18, 'Traditional', 3);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (19, '#BeforeQuarantineLife', 3);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (20, 'Aveiro', 3);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (21, '80s', 4);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (22, 'Live', 4);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (23, 'Earth Wind and Fire', 4);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (24, 'Stupid', 6);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (25, 'Stupid', 8);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (26, 'Ice', 6);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (27, 'Cars', 7);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (28, 'Lamborghini', 7);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (29, 'Lifestyle', 7);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (30, 'Sofa', 8);
INSERT INTO Tag_By_Video (id, name, video_id) VALUES (31, 'Airplane', 9);


INSERT INTO Comment_Video (id, video_id, reviewer_email, comment, creation_date) VALUES (1, 2, 'hugofpaiva@ua.pt', 'Nice video Mate', '2020-11-30');
INSERT INTO Comment_Video (id, video_id, reviewer_email, comment, creation_date) VALUES (2, 3, 'portugal@ua.pt', 'Great', '2020-11-30');
INSERT INTO Comment_Video (id, video_id, reviewer_email, comment, creation_date) VALUES (3, 1, 'pateta@ua.pt', 'Fantastic', '2020-12-1');
INSERT INTO Comment_Video (id, video_id, reviewer_email, comment, creation_date) VALUES (4, 1, 'bicho@ua.pt', 'Awesome', '2020-12-1');
INSERT INTO Comment_Video (id, video_id, reviewer_email, comment, creation_date) VALUES (5, 5, 'gonzalez@ua.pt', 'Maybe next time', '2020-12-2');
INSERT INTO Comment_Video (id, video_id, reviewer_email, comment, creation_date) VALUES (6, 7, 'hugofpaiva@ua.pt', 'What is this?', '2020-12-3');
INSERT INTO Comment_Video (id, video_id, reviewer_email, comment, creation_date) VALUES (7, 4, 'patriciapa@ua.pt', 'Am I alive?', '2020-12-4');
INSERT INTO Comment_Video (id, video_id, reviewer_email, comment, creation_date) VALUES (8, 1, 'patriciapa@ua.pt', 'Hello', '2020-12-4');
INSERT INTO Comment_Video (id, video_id, reviewer_email, comment, creation_date) VALUES (9, 9, 'hugofpaiva@ua.pt', 'Its', '2020-12-4');
INSERT INTO Comment_Video (id, video_id, reviewer_email, comment, creation_date) VALUES (10, 10, 'hello_nomad@ua.pt', 'Me', '2020-12-4');


INSERT INTO Comment_Reviewer (id, video_id, reviewer_email, comment, creation_date) VALUES (1, 2, 'hugofpaiva@ua.pt', 'Nice video Mate', '2020-11-30');
INSERT INTO Comment_Reviewer (id, video_id, reviewer_email, comment, creation_date) VALUES (2, 3, 'portugal@ua.pt', 'Great', '2020-11-30');
INSERT INTO Comment_Reviewer (id, video_id, reviewer_email, comment, creation_date) VALUES (3, 1, 'pateta@ua.pt', 'Fantastic', '2020-12-1');
INSERT INTO Comment_Reviewer (id, video_id, reviewer_email, comment, creation_date) VALUES (4, 1, 'bicho@ua.pt', 'Awesome', '2020-12-1');
INSERT INTO Comment_Reviewer (id, video_id, reviewer_email, comment, creation_date) VALUES (5, 5, 'gonzalez@ua.pt', 'Maybe next time', '2020-12-2');
INSERT INTO Comment_Reviewer (id, video_id, reviewer_email, comment, creation_date) VALUES (6, 7, 'hugofpaiva@ua.pt', 'What is this?', '2020-12-3');
INSERT INTO Comment_Reviewer (id, video_id, reviewer_email, comment, creation_date) VALUES (7, 4, 'patriciapa@ua.pt', 'Am I alive?', '2020-12-4');
INSERT INTO Comment_Reviewer (id, video_id, reviewer_email, comment, creation_date) VALUES (8, 1, 'patriciapa@ua.pt', 'Hello', '2020-12-4');
INSERT INTO Comment_Reviewer (id, video_id, reviewer_email, comment, creation_date) VALUES (9, 9, 'hugofpaiva@ua.pt', 'Its', '2020-12-4');
INSERT INTO Comment_Reviewer (id, video_id, reviewer_email, comment, creation_date) VALUES (10, 10, 'hello_nomad@ua.pt', 'Me', '2020-12-4');


/*
Type of events:
0 - Play
1 - Pause
2 - Stop
*/
INSERT INTO Event (id, video_id, user_email, creation_date, type, time) VALUES (1, 2, 'hello_nomad@ua.pt', toTimestamp(now()), 0, 50);
INSERT INTO Event (id, video_id, user_email, creation_date, type, time) VALUES (2, 1, 'pateta@ua.pt', toTimestamp(now()), 0, 33);
INSERT INTO Event (id, video_id, user_email, creation_date, type, time) VALUES (3, 1, 'bicho@ua.pt', toTimestamp(now()), 1, 675);
INSERT INTO Event (id, video_id, user_email, creation_date, type, time) VALUES (4, 4, 'pateta@ua.pt', toTimestamp(now()), 2, 123);
INSERT INTO Event (id, video_id, user_email, creation_date, type, time) VALUES (5, 9, 'bicho@ua.pt', toTimestamp(now()), 2, 234);
INSERT INTO Event (id, video_id, user_email, creation_date, type, time) VALUES (6, 5, 'gonzalez@ua.pt', toTimestamp(now()), 1, 65);
INSERT INTO Event (id, video_id, user_email, creation_date, type, time) VALUES (7, 3, 'gonzalez@ua.pt', toTimestamp(now()), 1, 45);
INSERT INTO Event (id, video_id, user_email, creation_date, type, time) VALUES (8, 7, 'hello_nomad@ua.pt', toTimestamp(now()), 0, 12);
INSERT INTO Event (id, video_id, user_email, creation_date, type, time) VALUES (9, 8, 'speedy@ua.pt', toTimestamp(now()), 2, 87);
INSERT INTO Event (id, video_id, user_email, creation_date, type, time) VALUES (10, 1, 'speedy@ua.pt', toTimestamp(now()), 0, 55);


                     
INSERT INTO Rating (id, video_id, rating) VALUES (1, 1, 3);
INSERT INTO Rating (id, video_id, rating) VALUES (2, 3, 5);
INSERT INTO Rating (id, video_id, rating) VALUES (3, 5, 1);
INSERT INTO Rating (id, video_id, rating) VALUES (4, 7, 3);
INSERT INTO Rating (id, video_id, rating) VALUES (5, 2, 4);
INSERT INTO Rating (id, video_id, rating) VALUES (6, 2, 5);
INSERT INTO Rating (id, video_id, rating) VALUES (7, 5, 2);
INSERT INTO Rating (id, video_id, rating) VALUES (8, 7, 2);
INSERT INTO Rating (id, video_id, rating) VALUES (9, 9, 2);
INSERT INTO Rating (id, video_id, rating) VALUES (10, 3, 2);

#Used this to export: cqlsh -e "select JSON * from cbd_3_2.User" | awk 'NR>3 {print $0}' > User.json


